<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Joining Tables</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
span.MsoPlaceholderText
	{color:gray;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
p.Stepheader, li.Stepheader, div.Stepheader
	{mso-style-name:"Step header";
	mso-style-link:"Step header Char";
	margin-top:7.5pt;
	margin-right:0in;
	margin-bottom:7.5pt;
	margin-left:0in;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
span.StepheaderChar
	{mso-style-name:"Step header Char";
	mso-style-link:"Step header";
	font-family:"Arial",sans-serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
p.Instructions, li.Instructions, div.Instructions
	{mso-style-name:Instructions;
	mso-style-link:"Instructions Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:13.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	color:#0070C0;}
span.InstructionsChar
	{mso-style-name:"Instructions Char";
	mso-style-link:Instructions;
	font-family:"Arial",sans-serif;
	color:#0070C0;}
p.Stepheader-GIS, li.Stepheader-GIS, div.Stepheader-GIS
	{mso-style-name:"Step header-GIS";
	mso-style-link:"Step header-GIS Char";
	margin-top:7.5pt;
	margin-right:0in;
	margin-bottom:7.5pt;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-after:avoid;
	background:#8DB3E2;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:white;
	font-weight:bold;}
span.Stepheader-GISChar
	{mso-style-name:"Step header-GIS Char";
	mso-style-link:"Step header-GIS";
	font-family:"Arial",sans-serif;
	color:white;
	background:#8DB3E2;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center'><b><span
style='font-size:16.0pt;color:#365F91'>Joining Tables to Maps</span></b></p>

<div class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center;line-height:13.0pt'><span
style='font-size:10.0pt;color:black'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</span></div>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=707 valign=top style='width:809.6pt;border:none;background:#F2F2F2;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:0in;margin-bottom:
  .0001pt;text-indent:-.25in;line-height:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span>Create a folder called <b>Table_join</b>. On DIA 322 computers, you
  might want to create this folder in your user Documents folder (e.g.
  C:\Users\jdoe\Documents\Table_join). On the DIA 222 computers, you might want
  to create this folder on the D: drive under D:\course number\user name\ (e.g.
  D:\ES212\jdoe\Table_join).</p>
  <p class=MsoListParagraphCxSpLast style='margin-top:7.5pt;margin-right:0in;
  margin-bottom:7.5pt;margin-left:.5in;text-indent:-.25in;line-height:13.0pt'><span
  style='color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><a href="Joining_tables_files/Table_join.zip">Download the data</a><span
  style='color:black'> for this exercise then </span><a
  href="Opening_zip_files.htm">uncompress</a><span style='color:black'> the <b>Table_join.zip</b>
  file to your newly created <b>Table_join</b> directory.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
12.75pt'><span style='font-size:10.0pt;color:black'>&nbsp;</span></p>

<p class=MsoNormal>Additional information on Joining Excel tables to GIS
features can be found <a
href="http://blogs.esri.com/Dev/blogs/arcgisdesktop/archive/2010/08/10/Working-with-Microsoft-Excel-in-ArcGIS-Desktop.aspx">here</a>.
Note: If you are working with Excel 2010 data, you may need to install the <a
href="http://www.microsoft.com/downloads/en/confirmation.aspx?familyid=7554f536-8c28-4598-9b72-ef94e038c891&amp;displaylang=en">2007
Office System Driver</a> (this driver is already installed on GIS lab PCs)</p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</div>

<p class=MsoTocHeading><a name="_Toc286147277">Contents</a></p>

<p class=MsoToc1><a href="#_Toc290557902">Step 1:<span style='font-family:"Calibri",sans-serif;
color:windowtext;text-decoration:none'>         </span>Create a new map
document<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc290557903">Step 2:<span style='font-family:"Calibri",sans-serif;
color:windowtext;text-decoration:none'>         </span>Modify a table for
ArcMap<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc1><a href="#_Toc290557904">Step 3:<span style='font-family:"Calibri",sans-serif;
color:windowtext;text-decoration:none'>         </span>Joining a table to a
layer<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoToc1><a href="#_Toc290557905">Step 4:<span style='font-family:"Calibri",sans-serif;
color:windowtext;text-decoration:none'>         </span>Exporting a join to a
new shapefile or geodatabase feature class<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc1><a href="#_Toc290557906">Step 5:<span style='font-family:"Calibri",sans-serif;
color:windowtext;text-decoration:none'>         </span>Performing another join<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</div>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc290557902">Step 1:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Create a new map document</a></p>

</div>

<p class=MsoNormal>You will create a new document where you will load a Maine
counties  layer.</p>

<p class=Instructions>From the <b>Start</b> menu, open <b>All Programs</b> <b>&gt;&gt;
ArcGIS &gt;&gt; ArcMap</b>.</p>

<p class=Instructions>In the <b>ArcMap – Getting</b> <b>Started</b> window,
select <b>New Maps </b>and<b> Blank Map </b>as the template. </p>

<p class=MsoNormal><img width=403 height=257 id="Picture 1"
src="Joining_tables_files/image001.png"></p>

<p class=Instructions>Click <b>OK</b>.</p>

<p class=MsoNormal>Next, you will load a new layer. The following step assumes
that you don’t have a folder connection to this project’s workplace.</p>

<p class=Instructions>Click on the <b>Add</b> <b>Data</b> button <img width=17
height=18 id="Picture 2" src="Joining_tables_files/image002.png">.</p>

<p class=Instructions>If a folder connection to your workplace does not yet
exist, click on the <b>Connect to Folder</b> button <img width=18 height=15
id="Picture 3" src="Joining_tables_files/image003.png"> then select your <b>Table_join</b>
folder.</p>

<p class=MsoNormal><img width=313 height=189 id="Picture 4"
src="Joining_tables_files/image004.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Connect to Folder</b>
window.</p>

<p class=MsoNormal>You should now see a list of data elements in the new folder
connection.</p>

<p class=MsoNormal><img width=333 height=178 id="Picture 5"
src="Joining_tables_files/image005.png"></p>

<p class=Instructions>Select <b>Counties</b> then click on the <b>Add </b>button.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc290557903">Step 2:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Modify a table for ArcMap</a></p>

</div>

<p class=MsoNormal>Now that you have a new map document open, you will add a
table to your map. The data file Alcohol_use_2008.csv is a comma delimited text
file that can be viewed in any text editor. A CSV stores data that are
separated by commas. The Alcohol_use_2008.csv file tabulates the percentage of
students between grades 6 and 12 who have consumed alcohol at least once. More
information about the data can be found <a
href="http://www.maine.gov/maineosa/survey/home.php">here</a>.</p>

<p class=MsoNormal><img border=0 width=263 height=326 id="Picture 19"
src="Joining_tables_files/image006.png"></p>

<p class=MsoNormal>Both CSV files and Excel files can be read into an ArcMap
document.  If you are using an older version of ArcGIS (10.3 or older) you will
need to clean up the column header names (see the following warning box).</p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='background:#F2DBDB;border-collapse:collapse;border:none'>
 <tr>
  <td width=47 valign=top style='width:35.45pt;background:#E5B8B7;padding:.1in 5.75pt .1in 5.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:36.0pt;color:red'>!!</span></b></p>
  </td>
  <td width=661 valign=top style='width:651.55pt;padding:.1in 5.75pt .1in 5.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>If you are using ArcMap <b>10.3</b> or older, the software has <a
  href="https://support.esri.com/en/technical-article/000005588">strict
  guidelines</a> when it comes to importing tables into ArcMap.  Table field
  names <u>cannot</u> contain non-alphanumeric characters such percent signs.
  It also cannot contain spaces, even at the beginning or end of the field
  name. ArcMap will accept underscores ‘_’ as a space substitute. A summary of
  field name requirements follow:</p>
  <p class=MsoListParagraphCxSpFirst style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names need to start with a <u>letter</u>.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names should only include <u>alphanumeric</u>
  characters or <u>underscores</u>.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.5in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='color:red'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>None of these:
  `~@#$%^&amp;*()-+=|\\,&lt;&gt;?/{}.!'[]:;</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.5in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='color:red'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>No spaces (That includes before the
  field name, in the middle, or after it.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names will be cut off after <u>64
  characters</u></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>There are certain reserved words that
  should be avoided. You can see the complete list </span><a
  href="http://support.microsoft.com/kb/286335"><b>here</b></a>.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=Instructions>From the <b>Start</b> menu find and open <b>Excel</b> (<b>All
Programs &gt;&gt; Microsoft Office &gt;&gt; Microsoft Excel</b>).</p>

<p class=MsoNormal>The following steps assume that you are working with Excel
2010 or newer. If you are using a different version, the interface may look
somewhat different.</p>

<p class=Instructions>In <b>Excel</b>, click the <b>File</b> tab.</p>

<p class=Instructions><img border=0 width=170 height=111 id="Picture 9"
src="Joining_tables_files/image007.png"></p>

<p class=Instructions>In the <b>File</b> tab, click on the <b>Open</b> Button.</p>

<p class=Instructions>In the <b>Open</b> dialog window, locate and open the <b>Alcohol_use_2008.csv</b>
in your project directory (e.g. D:\login_name\Table_join). To view the .csv
files in your directory, you might need to select <b>Text Files</b> from the
pull-down menu in the lower right-hand corner of the window.</p>

<p class=Instructions><img border=0 width=389 height=452 id="Picture 10"
src="Joining_tables_files/image008.png"></p>

<p class=MsoNormal>Next, you will clean up the column headers to meet the
aforementioned requirements which include no percent characters and no spaces
(note that this change is not needed for ArcMap version 10.4.1 and later). </p>

<p class=Instructions>Change the headers “County name”, “% no use” and “% use”
to “County_name”, “Percent_no_use” and “Percent_use”.</p>

<p class=MsoNormal><img border=0 width=383 height=187 id="Picture 13"
src="Joining_tables_files/image009.png"></p>

<p class=MsoNormal>After making the edits, we will save the file as an Excel
file.</p>

<p class=Instructions>Click on the <b>File</b> tab then click on <b>Save As</b>.</p>

<p class=Instructions>Select <b>Excel Workbook</b> as file type.</p>

<p class=Instructions><img border=0 width=431 height=170 id="Picture 27"
src="Joining_tables_files/image010.png"></p>

<p class=Instructions>Name the output file <b>Alcohol_use_2008.xlsx</b> in the
Table_join folder.</p>

<p class=Instructions><b>Save </b>the file then<b> Close</b> Excel.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc290557904">Step 3:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Joining a table to a layer</a></p>

</div>

<p class=Instructions>Go back to you ArcMap session and add the <b>Alcohol_use_2008.xlsx</b>
file by clicking on the <b>Add Data</b> button <img border=0 width=17
height=18 id="Picture 15" src="Joining_tables_files/image002.png">.</p>

<p class=MsoNormal>You can only load a single worksheet from a spreadsheet,
therefore ArcGIS requires that you explicitly select the worksheet to load.</p>

<p class=Instructions><b>Double-click</b> on <b>Alcohol_use_2008.xlsx</b>.</p>

<p class=MsoNormal>There is only one worksheet in our Excel file. </p>

<p class=Instructions><b>Select</b> the only <b>worksheet</b> and click <b>Add</b>.</p>

<p class=Instructions><img border=0 width=332 height=168 id="Picture 47"
src="Joining_tables_files/image011.png"></p>

<p class=MsoNormal>At this point, ArcMap will have loaded the table in the TOC.</p>

<p class=MsoNormal><img border=0 width=376 height=215 id="Picture 51"
src="Joining_tables_files/image012.png"></p>

<p class=MsoNormal>You may notice that the TOC environment has changed. Since
tables cannot be viewed in the standard <b>List By Drawing Order</b> <img
border=0 width=24 height=22 id="Picture 16"
src="Joining_tables_files/image013.png"> environment ArcMap switched to the <b>List
By Source</b> environment <img border=0 width=22 height=20 id="Picture 17"
src="Joining_tables_files/image014.png">. Don’t forget that you can toggle back
and forth between these TOC views by clicking on the appropriate button near
the top of the TOC window pane. </p>

<p class=Instructions><b>Right-click</b> on the <b>Alcohol_use_2008</b> table and
select <b>Open</b>.</p>

<p class=MsoNormal>The table should look just as it did in Excel.</p>

<p class=Instructions><img border=0 width=359 height=325 id="Picture 20"
src="Joining_tables_files/image015.png"></p>

<p class=MsoNormal>Next, we will join this table to the existing data layer
(Counties) in the ArcMap document. To join a table, to an existing layer, a
field (attribute) common to both tables must exist. Let’s view the Counties
layer’s attribute table.</p>

<p class=Instructions>In the <b>TOC</b>, right-click on <b>Counties</b> and
select <span class=InstructionsChar>Open Attribute Table</span>.</p>

<p class=MsoNormal>The Counties layer has an attribute called COUNTY that will
be used to join the csv table to the Counties layer. A successful join requires
that all records in both tables be identical--character for character. This
means that a discrepancy as benign as a character’s case (upper case vs lower
case) will result in an unsuccessful join.</p>

<p class=MsoNormal><img border=0 width=488 height=572 id="Picture 22"
src="Joining_tables_files/image016.png"></p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Joins and Relates &gt;&gt; Join</b>.</p>

<p class=Instructions>In the <b>Join Data</b> window select <b>Join attributes
from a table</b> in the first pull-down menu, <b>COUNTY</b> in the first field,
<b>Alcohol_use_2008</b> in the second field and <b>County_name</b> in the third
field (see graphic below).</p>

<p class=Instructions><img border=0 width=454 height=406 id="Picture 52"
src="Joining_tables_files/image017.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Join Data</b> window.</p>

<p class=MsoNormal>In the Counties attribute table you should see the attribute
columns from the Excel table (County_name, Percent_no_use and Percent_use)
appended to the end of the Counties attribute table. At this point, you can
work with the appended attributes as though they belonged to the original
Counties layer.</p>

<p class=MsoNormal><img border=0 width=462 height=334 id="Picture 11"
src="Joining_tables_files/image018.png"></p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Properties</b>.</p>

<p class=Instructions>In the <b>Layer Properties</b> window, select the <b>Symbology</b>
tab. </p>

<p class=Instructions>Select <b>Quantities</b> in the <b>Show</b> window on the
left side of the <b>Layer Properties</b> window.</p>

<p class=Instructions>Select <b>Percent_use</b> for the <b>Value</b> field.</p>

<p class=Instructions><img border=0 width=435 height=257 id="Picture 12"
src="Joining_tables_files/image019.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Layer Properties</b>
window.</p>

<p class=Instructions><img border=0 width=190 height=254 id="Picture 21"
src="Joining_tables_files/image020.png"></p>

<p class=MsoNormal>It’s always good practice to save your map document on a
regular basis. Now is a good time to do so.</p>

<p class=Instructions>From the <b>File</b> pull-down menu, select <b>File
&gt;&gt; Save As</b>.</p>

<p class=Instructions>In the <b>Save As</b> window, navigate to the D:\login_name\Table_join
folder and save the document as <b>Join_exercise.mxd</b>.</p>

<p class=Instructions><img border=0 width=364 height=225 id="Picture 23"
src="Joining_tables_files/image021.png"></p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc290557905">Step 4:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Exporting a join to a new shapefile or geodatabase feature class</a></p>

</div>

<p class=MsoNormal>The join that you have created so far is only temporary and
exists “virtually” within the current ArcMap session. In other words, if you
were to load the Counties layer into a new MXD document, the join would be
gone. To make the join permanent, you need to export the layer (and its joined
table) to a new feature.</p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Data &gt;&gt; Export Data</b>.</p>

<p class=Instructions>In the <b>Export Data</b> window select <b>All features</b>
from the <b>Export</b> pull-down menu and name the output <b>Alcohol_by_county.shp</b>.</p>

<p class=Instructions><img border=0 width=429 height=245 id="Picture 24"
src="Joining_tables_files/image022.png"></p>

<p class=Instructions>Click <b>OK</b> to save the file.</p>

<p class=Instructions>When prompted to add the exported data to the map, click <b>Yes</b>.</p>

<p class=MsoNormal>Go ahead and symbolize the new layer as you did with the
original one near the end of step 3. You will use the Percent_use attribute for
the field value. </p>

<p class=MsoNormal><u><span style='color:#C00000'>Note</span></u><span
style='color:#C00000'>: when exporting to a shapefile, field names longer than
10 characters will be truncated to the first ten characters. If you want to
save a GIS layer with attribute field names longer than 19 characters, you need
to export the layer to a geodatabase.</span></p>

<p class=MsoNormal>Next, you will remove the join from the original Counties layer.</p>

<p class=Instructions>In  the <b>TOC</b>, right-click on <b>Counties</b> and
select <b>Joins and Relates &gt;&gt; Remove Join(s) &gt;&gt; Remove All Joins</b>.</p>

<p class=MsoNormal>In the next step you will join another table that will have additional
challenges.</p>

<p class=Instructions>Save the document by clicking on the <b>Save</b> button <img
border=0 width=20 height=18 id="Picture 25"
src="Joining_tables_files/image023.png">.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc290557906">Step 5:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Performing another join</a></p>

</div>

<p class=MsoNormal>Next, you will join another table to the Counties layer. The
table to be joined contains estimated median income data for 2009 (src: US
Census). The table is also in a CSV file however this time, therefore you will
save it as an Excel file then join that file to the Counties layer. </p>

<p class=Instructions>In the Windows file management window, double-click on
the <span class=InstructionsChar><b>Estimated_median_income_2009</b></span>
file located in the Table_join folder.</p>

<p class=MsoNormal>The file should open in an Excel application. Notice that
the table does not have county names listed, instead, the table identifies the
county by ID. This is OK since the Counties layer in the ArcMap document has a
county code column called <b>CNTYCODE</b>.</p>

<p class=MsoNormal><img border=0 width=274 height=421 id="Picture 26"
src="Joining_tables_files/image024.png"></p>

<p class=MsoNormal>Before we save this CSV file to an Excel file, do you see
anything that needs to be changed? Remember the field name requirements covered
in Step 2? You will clean up the header names to meet ArcMap’s table
requirements.</p>

<p class=Instructions>Replace all spaces in the header names with underscore
‘_’ and move the ‘2009’ text to the end of the header name in the second
column.</p>

<p class=MsoNormal>Your table header should look like the following:</p>

<p class=MsoNormal><img border=0 width=312 height=145 id="Picture 28"
src="Joining_tables_files/image025.png"></p>

<p class=MsoNormal>Save the CSV file as an Excel file.</p>

<p class=Instructions>In the Excel application, click on the <b>File</b> tab
then <b>Save As</b>.</p>

<p class=Instructions>In the <b>Save As</b> window, select <b>.xlsx</b> as the
file type and name the output <b>Estimated_median_income_2009.xlsx</b>. Make
sure that the file is saved in the Table_join folder.</p>

<p class=Instructions><img border=0 width=384 height=112 id="Picture 29"
src="Joining_tables_files/image026.png"></p>

<p class=Instructions>Click <b>Save</b> to save the file and <b>exit</b> Excel.</p>

<p class=MsoNormal><u><span style='color:#C00000'>NOTE</span></u><span
style='color:#C00000'>: always make sure to close an Excel file that is open inside
an Excel application before opening it in ArcMap. If you don’t, ArcMap will not
open the file because of a file lock placed on the file by the Excel
application.</span></p>

<p class=Instructions>In ArcMap, click on the <b>Add Data</b> button <img
border=0 width=20 height=19 id="Picture 30"
src="Joining_tables_files/image027.png">.</p>

<p class=Instructions>In the <b>Add Data</b> window, you will see two
Estimated_median_income_2009 files. Select the <b>Excel</b> version.</p>

<p class=Instructions><img border=0 width=364 height=226 id="Picture 31"
src="Joining_tables_files/image028.png"></p>

<p class=Instructions>Click <b>Add</b> to add the data.</p>

<p class=MsoNormal>You will notice that the Add Data window did not close, nor
did the Excel file get added to the ArcMap document. Instead The Add Data
window is displaying the Excel file’s sheet(s). The reason for this is that
ArcMap can only add a single Excel sheet at the time. This is not a problem for
us since our Excel file only has a single sheet.</p>

<p class=MsoNormal><img border=0 width=335 height=162 id="Picture 32"
src="Joining_tables_files/image029.png"></p>

<p class=Instructions>In the Add Data window, select <b>Estimated_median_income_2009$</b>
then click <b>Add</b>.</p>

<p class=MsoNormal>You now should see the median income table in the table of
content. At this point, it’s always good practice to open the contents of the
table to make sure that all data have been properly read.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Estimated_median_income_2009</b>
table and select <b>Open</b>.</p>

<p class=Instructions><img border=0 width=303 height=326 id="Picture 33"
src="Joining_tables_files/image030.png"></p>

<p class=MsoNormal>It seems that all data and headers were properly imported.
Now let’s try the join. Remember that this time around, we will join the Excel
table to the Counties table using the County IDs instead of the County names.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Joins and Relates &gt;&gt; Joins</b>.</p>

<p class=Instructions>In the Join Data window, select <b>Join attributes from a
table</b> from the first pull-down option, then <b>CNTYCODE</b> from the second
pull-down menu (this is the column from the Counties layer that is used to join
the table with) and select <b>Estimated_median_income_2009$ </b>in the third
pull-down menu.</p>

<p class=Instructions>Now try selecting a field from the <b>Choose the fields
in the table to base the join on</b> pull-down menu. The options should be
blank.</p>

<p class=MsoNormal><img border=0 width=447 height=430 id="Picture 34"
src="Joining_tables_files/image031.png"></p>

<p class=MsoNormal>So what happened? Why is ArcMap not letting us select any
columns from the Excel table? Well not only do the records between both tables
need to match character for character, but they also need to match by <b>data
type</b>. So we need to figure out the data types for each table.</p>

<p class=MsoNormal>If the spreadsheet’s attribute table is not opened, go ahead
and open it. (e.g. in the TOC, right-click on the table layer and select <b>open</b>).</p>

<p class=Instructions>In the attribute table, <b>right-click</b> on the
County_ID header and select <b>Properties.</b></p>

<p class=MsoNormal><img border=0 width=268 height=408 id="Picture 35"
src="Joining_tables_files/image032.png"></p>

<p class=MsoNormal>In the Field Properties window, note the data type. The
Excel file saved the column as a Double data type (which is a numeric data
type). In other words, Excel (and ArcMap by extension) is treating the column
as a <b>number</b> field.</p>

<p class=MsoNormal> <img border=0 width=369 height=135 id="Picture 37"
src="Joining_tables_files/image033.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Field Properties</b>
window.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Open Attribute Table</b>.</p>

<p class=Instructions>In the Table window, <b>right-click</b> on the <b>CNTYCODE</b>
column header and select <b>Properties</b>.</p>

<p class=MsoNormal>In this table, the county ID is treated as a <b>String</b>
(which is a text or character format) and not a numeric field. Because the data
types between both tables do not match, we cannot join the tables. There are
several solutions to this problem; one that involves changing the data type in
the Excel table.</p>

<p class=MsoNormal><img border=0 width=363 height=141 id="Picture 36"
src="Joining_tables_files/image034.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Field Properties</b> window.</p>

<p class=MsoNormal>Because ArcMap places a lock on the table, it cannot be
opened for editing in Excel. We will need to close ArcMap before opening the
Excel file for editing.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on <b>the
Estimated_median_income_2009 </b>layer and select <b>Remove</b>.</p>

<p class=Instructions><b>Save</b> the ArcMap project and <b>close</b> ArcMap.</p>

<p class=Instructions>In a Windows file management window, <b>open</b> the <b>Estimated_median_income_2009.xlsx</b>
file by double-clicking on it (the file should be in your Table_join folder).</p>

<p class=Instructions>In the Excel window, <b>right-click</b> on the <b>County_ID</b>
<b>column</b> (i.e. right-click on the A column header) and select <b>Format Cells</b>.
                                                                                                                                                                                 </p>

<p class=Instructions><img border=0 width=229 height=309 id="Picture 53"
src="Joining_tables_files/image035.png"></p>

<p class=Instructions>Under the <b>Number</b> tab select <b>Text</b> then click
<b>OK</b> to close the Format Cells Window.</p>

<p class=Instructions><img border=0 width=200 height=385 id="Picture 38"
src="Joining_tables_files/image036.png"></p>

<p class=MsoNormal>You may recall that the CNTYCODE column from the Counties
layer had single digits padded with 0s (e.g. 01, 03, etc…). We will need to rectify
this in the Excel table since the values will need to match character for
character.</p>

<p class=Instructions>Add the number <b>0</b> in front of all single digits in
the County_ID column.</p>

<p class=MsoNormal><img border=0 width=284 height=415 id="Picture 39"
src="Joining_tables_files/image037.png"></p>

<p class=Instructions><b>Save</b> the Excel file then <b>close</b> Excel.</p>

<p class=Instructions>Using the Windows file management navigate to your
Table_join folder and double-click on the <b>Join_exercise.mxd</b> file to open
the ArcMap document.</p>

<p class=Instructions>Click on the <b>Add Data</b> button and add the <b>Estimated_median_income_2009$
</b>sheet from the Excel file (remember that you can only load one Excel sheet
at a time).</p>

<p class=MsoNormal>Again, it’s always good practice to check the data.</p>

<p class=Instructions><b>Right-click</b> on the <b>Estimated_median_income_2009$</b>
layer and select <b>Open</b>.</p>

<p class=MsoNormal>Feel free to check the County_ID properties to ensure that
it is now a String data type. You can also tell whether or not an attribute is
numeric  by the data value’s left/right justification. Left justified data
indicate a string (non-numeric) data type and right-justified data indicate
numeric data type.</p>

<p class=MsoNormal><img border=0 width=304 height=326 id="Picture 40"
src="Joining_tables_files/image038.png"></p>

<p class=MsoNormal>Now that we have matching county ID values between the
Counties layer and the Excel table we can proceed with the join.</p>

<p class=Instructions><b>Right-click</b> on the <b>Counties</b> layer and
select <b>Joins and Relates &gt;&gt; Joins</b>.</p>

<p class=Instructions>In the Join Data window select the values for each field
as shown below:</p>

<p class=MsoNormal><img border=0 width=432 height=499 id="Picture 41"
src="Joining_tables_files/image039.png"></p>

<p class=Instructions>Click <b>OK</b> to close the Join data window.</p>

<p class=MsoNormal>The median income data is now joined to the Counties layer.
Remember that this join is temporary. If you want it to be permanent, you must
export it to a new data file. But first let’s make sure that the join was successful.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Open Attribute table</b>. </p>

<p class=MsoNormal>Make sure that the Excel columns are properly appended to
the table</p>

<p class=MsoNormal><img border=0 width=434 height=175 id="Picture 42"
src="Joining_tables_files/image040.png"></p>

<p class=MsoNormal>Before exporting the joined layer to a new data file we will
remove unnecessary/redundant attributes.</p>

<p class=Instructions>In the <b>TOC</b>, right-click the <b>Counties</b> layer
and select <b>Properties</b>. </p>

<p class=Instructions>In the Layer Properties window, select <b>Fields</b>.</p>

<p class=MsoNormal><img border=0 width=173 height=79 id="Picture 44"
src="Joining_tables_files/image041.png"></p>

<p class=MsoNormal>This option lets you control which attributes will be
useable within your map session. It also defines which attributes will be exported
in an export process.</p>

<p class=MsoNormal><img border=0 width=243 height=196 id="Picture 45"
src="Joining_tables_files/image042.png"></p>

<p class=Instructions>You will uncheck the <b>Shape</b>, <b>CountyCode</b> and <b>County_ID</b>
attributes.</p>

<p class=MsoNormal><img border=0 width=231 height=184 id="Picture 46"
src="Joining_tables_files/image043.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Layer Properties</b>
window.</p>

<p class=MsoNormal>If you view the Counties layer attribute table, you should
now only see three columns. </p>

<p class=MsoNormal>Now we are ready to export the layer to a new data file.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Data &gt;&gt; Export Data</b>.</p>

<p class=Instructions>Name the new data file <b>Income_by_county.shp</b>.</p>

<p class=MsoNormal><img border=0 width=317 height=237 id="Picture 48"
src="Joining_tables_files/image044.png"></p>

<p class=Instructions>Click <b>OK</b> to proceed with the export.</p>

<p class=Instructions>When asked if the exported data should be added to the
map as a layer, click <b>Yes</b>.</p>

<p class=MsoNormal><img border=0 width=321 height=129 id="Picture 49"
src="Joining_tables_files/image045.png"></p>

<p class=MsoNormal>Go ahead and symbolize the newly added layer using the <b>Estimated_</b>
(this is the estimated median income attribute; remember that Shapefile formats
will truncate attribute names longer than 10 characters). If you forgot how to
symbolize a layer, see Step 3.</p>

<p class=MsoNormal><img border=0 width=224 height=297 id="Picture 50"
src="Joining_tables_files/image046.png"></p>

<p class=Instructions><b>Save</b> the MXD file.</p>

<p class=MsoNormal>This completes the steps for this exercise.</p>

<div class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center;line-height:13.0pt'><span
style='font-size:10.0pt;color:black'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</span></div>

<p class=MsoNormal style='margin-top:7.5pt;margin-right:0in;margin-bottom:7.5pt;
margin-left:0in;line-height:13.0pt'><span style='font-size:10.0pt;color:gray'><img
border=0 width=76 height=27 id="Picture 6"
src="Joining_tables_files/image047.png"></span><span style='font-size:10.0pt;
color:gray'> Manuel Gimond, last modified on 1/11/2018 </span></p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
