<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Joining tables</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
span.MsoPlaceholderText
	{color:gray;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma",sans-serif;}
p.Stepheader, li.Stepheader, div.Stepheader
	{mso-style-name:"Step header";
	mso-style-link:"Step header Char";
	margin-top:7.5pt;
	margin-right:0in;
	margin-bottom:7.5pt;
	margin-left:0in;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria",serif;
	color:#365F91;
	font-weight:bold;}
span.StepheaderChar
	{mso-style-name:"Step header Char";
	mso-style-link:"Step header";
	font-family:"Arial",sans-serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria",serif;
	color:#4F81BD;
	font-weight:bold;}
p.Instructions, li.Instructions, div.Instructions
	{mso-style-name:Instructions;
	mso-style-link:"Instructions Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	line-height:13.0pt;
	font-size:12.0pt;
	font-family:"Arial",sans-serif;
	color:#0070C0;}
span.InstructionsChar
	{mso-style-name:"Instructions Char";
	mso-style-link:Instructions;
	font-family:"Arial",sans-serif;
	color:#0070C0;}
p.Stepheader-GIS, li.Stepheader-GIS, div.Stepheader-GIS
	{mso-style-name:"Step header-GIS";
	mso-style-link:"Step header-GIS Char";
	margin-top:7.5pt;
	margin-right:0in;
	margin-bottom:7.5pt;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-after:avoid;
	background:#8DB3E2;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Arial",sans-serif;
	color:white;
	font-weight:bold;}
span.Stepheader-GISChar
	{mso-style-name:"Step header-GIS Char";
	mso-style-link:"Step header-GIS";
	font-family:"Arial",sans-serif;
	color:white;
	background:#8DB3E2;
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center'><b><span
style='font-size:16.0pt;color:#365F91'>Joining Tables to Maps</span></b></p>

<div class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center;line-height:13.0pt'><span
style='font-size:10.0pt;color:black'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</span></div>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=899 valign=top style='width:809.6pt;border:none;background:#F2F2F2;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoListParagraphCxSpFirst style='margin-bottom:0in;margin-bottom:
  .0001pt;text-indent:-.25in;line-height:normal'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span>Create a folder called <b>Table_join</b><span style='color:black;
  background:#F2F2F2'>&nbsp;somewhere under your personal directory (e.g.
  C:\Users\jdoe\Documents\Tutorials\</span>Table_join).</p>
  <p class=MsoListParagraphCxSpLast style='margin-top:7.5pt;margin-right:0in;
  margin-bottom:7.5pt;margin-left:.5in;text-indent:-.25in;line-height:13.0pt'><span
  style='color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><a href="Joining_tables_files/Table_join.zip">Download the data</a><span
  style='color:black'> for this exercise then </span><a
  href="Opening_zip_files.htm">uncompress</a><span style='color:black'> the <b>Table_join.zip</b>
  file to your newly created <b>Table_join</b> directory.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
12.75pt'><span style='font-size:10.0pt;color:black'>&nbsp;</span></p>

<p class=MsoNormal>Note: If you are working with Excel data files, you may need
to install the <a
href="http://www.microsoft.com/downloads/en/confirmation.aspx?familyid=7554f536-8c28-4598-9b72-ef94e038c891&amp;displaylang=en">2007
Office System Driver</a> (this driver is already installed on GIS lab PCs).</p>

<p class=MsoNormal>This exercise will introduce you to joining (non-spatial)
data tables to existing GIS data files. You will join two data table type: an
Excel file and a CSV file.</p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</div>

<p class=MsoTocHeading><a name="_Toc286147277">Contents</a></p>

<p class=MsoToc1><a href="#_Toc519173520">Step 1:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Create a new map document<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173521">Step 2:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>A note about field names if using version 10.3 or older<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173522">Step 3:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Joining an Excel table to a layer<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173523">Step 4:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Exporting a join to a new shapefile<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173524">Step 5:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Attempting a join (and failing)<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173525">Step 6:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Converting text column to numeric column<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc519173526">Step 7:<span style='font-size:11.0pt;
line-height:115%;font-family:"Calibri",sans-serif;color:windowtext;text-decoration:
none'>        </span>Attempting the join one more time<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<div class=MsoNormal align=center style='text-align:center'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</div>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173520">Step 1:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Create a new map document</a></p>

</div>

<p class=MsoNormal>You will create a new ArcMap document where you will load the
Maine counties layer.</p>

<p class=Instructions>From the <b>Windows</b> menu <span style='position:relative;
top:3.0pt'><img width=26 height=24 id="Picture 7"
src="Joining_tables_files/image001.png"></span>, open <b>ArcGIS &gt;&gt; ArcMap
10.x</b>.</p>

<p class=Instructions>In the <b>ArcMap – Getting</b> <b>Started</b> window,
select <b>New Maps </b>and<b> Blank Map </b>as the template. </p>

<p class=MsoNormal><img width=352 height=206 id="Picture 1"
src="Joining_tables_files/image002.png"></p>

<p class=Instructions>Click <b>OK</b>.</p>

<p class=MsoNormal>Next, you will load a new layer. The following step assumes
that you don’t have a folder connection to this project’s workspace.</p>

<p class=Instructions>Click on the <b>Add</b> <b>Data</b> button <img width=17
height=18 id="Picture 2" src="Joining_tables_files/image003.png">.</p>

<p class=Instructions>If a folder connection to your workplace does not yet
exist, click on the <b>Connect to Folder</b> button <img width=18 height=15
id="Picture 3" src="Joining_tables_files/image004.png"> then select your <b>Table_join</b>
folder.</p>

<p class=MsoNormal><img width=443 height=190 id="Picture 8"
src="Joining_tables_files/image005.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Connect to Folder</b>
window.</p>

<p class=MsoNormal>You should now see a list of data elements in the new folder
connection.</p>

<p class=MsoNormal><img width=338 height=130 id="Picture 4"
src="Joining_tables_files/image006.png"></p>

<p class=Instructions>Select <b>Counties</b> then click on the <b>Add </b>button.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173521">Step 2:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>A note about field names if using version 10.3 or older</a></p>

</div>

<p class=MsoNormal>Both CSV files and Excel files can be read into an ArcMap
document.  However, if you are using a version of ArcMap 10.3 or older, read
the following warning box.</p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='background:#F2DBDB;border-collapse:collapse;border:none'>
 <tr>
  <td width=47 valign=top style='width:35.45pt;background:#E5B8B7;padding:.1in 5.75pt .1in 5.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:36.0pt;color:red'>!!</span></b></p>
  </td>
  <td width=853 valign=top style='width:651.55pt;padding:.1in 5.75pt .1in 5.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'>If you are using ArcMap <b>10.3</b> or older, the software has <a
  href="https://support.esri.com/en/technical-article/000005588">strict
  guidelines</a> when it comes to importing tables into ArcMap.  Table field
  names <u>cannot</u> contain non-alphanumeric characters such percent signs.
  It also cannot contain spaces, even at the beginning or end of the field
  name. ArcMap will accept underscores ‘_’ as a space substitute. A summary of
  field name requirements follow:</p>
  <p class=MsoListParagraphCxSpFirst style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names need to start with a <u>letter</u>.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names should only include <u>alphanumeric</u>
  characters or <u>underscores</u>.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.5in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='color:red'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>None of these:
  `~@#$%^&amp;*()-+=|\\,&lt;&gt;?/{}.!'[]:;</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.5in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='color:red'>-<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>No spaces (That includes before the field
  name, in the middle, or after it.</span></p>
  <p class=MsoListParagraphCxSpMiddle style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol;color:red'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>Field names will be cut off after <u>64
  characters</u></span></p>
  <p class=MsoListParagraphCxSpLast style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.0in;margin-bottom:.0001pt;text-indent:-.25in;
  line-height:normal'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='color:red'>There are certain reserved words that
  should be avoided. You can see the complete list </span><a
  href="http://support.microsoft.com/kb/286335"><b>here</b></a>.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173522">Step 3:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Joining an Excel table to a layer</a></p>

</div>

<p class=MsoNormal>Now that you have a new map document open, you will add a
table to your map. The data file Alcohol_use_2008.xlsx is an Excel file that
tabulates the percentage of students between grades 6 and 12 who have consumed
alcohol at least once. More information about the data can be found <a
href="http://www.maine.gov/maineosa/survey/home.php">here</a>.</p>

<p class=Instructions>In ArcMap click on the <b>Add Data</b> button <img
border=0 width=17 height=18 id="Picture 15"
src="Joining_tables_files/image003.png">.</p>

<p class=MsoNormal>Excel files can store multiple sheets (tabs) however, ArcMap
will read just one sheet at a time. This  Excel file has a single sheet  <span
style='position:relative;top:5.0pt'><img border=0 width=141 height=32
id="Picture 5" src="Joining_tables_files/image007.png"></span>. </p>

<p class=Instructions>In the<b> </b>Table_join project folder<b> double-click</b>
on <b>Alcohol_use_2008.xlsx</b> to expose its datasheet.</p>

<p class=Instructions><b><img border=0 width=236 height=130 id="Picture 18"
src="Joining_tables_files/image008.png"></b></p>

<p class=Instructions><b>Select</b> the <b>worksheet</b> and click <b>Add</b>.</p>

<p class=Instructions><img border=0 width=270 height=94 id="Picture 43"
src="Joining_tables_files/image009.png"></p>

<p class=MsoNormal>You should now see the table in the TOC.</p>

<p class=MsoNormal><img border=0 width=442 height=162 id="Picture 54"
src="Joining_tables_files/image010.png"></p>

<p class=MsoNormal>You may notice that the TOC environment has changed. Since
tables cannot be viewed in the standard <b>List By Drawing Order</b> <img
border=0 width=24 height=22 id="Picture 16"
src="Joining_tables_files/image011.png"> environment, ArcMap switched the TOC to
the <b>List By Source</b> environment <img border=0 width=22 height=20
id="Picture 17" src="Joining_tables_files/image012.png">. Don’t forget that you
can toggle back and forth between these TOC views by clicking on the
appropriate button near the top of the TOC window pane. </p>

<p class=Instructions><b>Right-click</b> on the <b>Alcohol_use_2008</b> table and
select <b>Open</b>.</p>

<p class=MsoNormal>The table should look just as it does in Excel.</p>

<p class=Instructions><img border=0 width=248 height=352 id="Picture 55"
src="Joining_tables_files/image013.png"></p>

<p class=MsoNormal>Next, we will join this table to the existing data layer (Counties)
in the ArcMap document. To join a table, to an existing layer, a field common
to both tables must exist. Let’s view the Counties layer’s attribute table.</p>

<p class=Instructions>In the <b>TOC</b>, right-click on <b>Counties</b> and
select <span class=InstructionsChar>Open Attribute Table</span>.</p>

<p class=MsoNormal>The Counties layer has an attribute called <b>COUNTY</b>
that will be keyed to Excel’s <b>County_name</b> field. Note that a successful
join requires that all records in both tables be identical--character for
character. This means that a discrepancy as benign as a character’s case (upper
case vs lower case) will result in an unsuccessful join. Note too that you do
not need to have the same number of records in both tables. The join can be
one-to-many (i.e. one record in the Excel file can be joined to multiple
records in the data layer).</p>

<p class=MsoNormal><img border=0 width=601 height=337 id="Picture 56"
src="Joining_tables_files/image014.png"></p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Joins and Relates &gt;&gt; Join</b>.</p>

<p class=Instructions>In the <b>Join Data</b> window select <b>Join attributes
from a table</b> in the first pull-down menu, <b>COUNTY</b> in the first field,
<b>Alcohol_use_2008</b> in the second field and <b>County name</b> in the third
field (see graphic below).</p>

<p class=Instructions><img border=0 width=415 height=433 id="Picture 57"
src="Joining_tables_files/image015.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Join Data</b> window.</p>

<p class=MsoNormal>In the Counties attribute table you should see the attribute
columns from the Excel appended to the end of the Counties attribute table. </p>

<p class=MsoNormal><img border=0 width=565 height=175 id="Picture 58"
src="Joining_tables_files/image016.png"></p>

<p class=MsoNormal>At this point, you can work with the appended attributes as
though they belonged to the original Counties layer.</p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Properties</b>.</p>

<p class=Instructions>In the <b>Layer Properties</b> window, select the <b>Symbology</b>
tab. </p>

<p class=Instructions>Select <b>Quantities</b> in the <b>Show</b> window on the
left side of the <b>Layer Properties</b> window.</p>

<p class=Instructions>Select <b>% use </b>for the <b>Value</b> field.</p>

<p class=Instructions><img border=0 width=436 height=185 id="Picture 59"
src="Joining_tables_files/image017.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Layer Properties</b>
window.</p>

<p class=Instructions><img border=0 width=191 height=251 id="Picture 21"
src="Joining_tables_files/image018.png"></p>

<p class=MsoNormal>It’s always good practice to save your map document on a
regular basis. Now is a good time to do so.</p>

<p class=Instructions>From the <b>File</b> pull-down menu, select <b>File
&gt;&gt; Save As</b>.</p>

<p class=Instructions>In the <b>Save As</b> window, navigate to the Table_join
folder and save the document as <b>Join_exercise.mxd</b>.</p>

<p class=Instructions>&nbsp;</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173523">Step 4:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Exporting a join to a new shapefile</a></p>

</div>

<p class=MsoNormal>The join that you have created so far is only temporary and
exists “virtually” within the current ArcMap session. In other words, if you
were to load the Counties layer into a new MXD document, the join would be
gone. To make the join permanent, you need to export the layer (and its joined
table) to a new feature.</p>

<p class=Instructions>In the <b>TOC</b>, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Data &gt;&gt; Export Data</b>.</p>

<p class=Instructions>In the <b>Export Data</b> window select <b>All features</b>
from the <b>Export</b> pull-down menu and name the output <b>Alcohol_by_county.shp</b>
(make sure to save it as a shapefile and not a geodatabase file).</p>

<p class=Instructions><img border=0 width=925 height=354 id="Picture 60"
src="Joining_tables_files/image019.png"></p>

<p class=Instructions>Click <b>OK</b> to save the file.</p>

<p class=Instructions>When prompted to add the exported data to the map, click <b>Yes</b>.</p>

<p class=MsoNormal><u><span style='color:#C00000'>Note</span></u><span
style='color:#C00000'>: when exporting to a shapefile, field names longer than
10 characters will be truncated to the first ten characters. Also, spaces and
non-alphanumeric characters get converted to underscores and letters. </span></p>

<p class=MsoNormal><span style='color:#C00000'><img border=0 width=747
height=270 id="Picture 61" src="Joining_tables_files/image020.png"></span></p>

<p class=MsoNormal>It’s usually good practice to import tables with simple field
names as outlined in Step 2 even though it will not impede an ArcMap workflow.</p>

<p class=Instructions>Go ahead and symbolize the new layer as you did with the
original one near the end of step 3. You will use the <b>F__use</b> attribute
for the field value. </p>

<p class=MsoNormal>Next, you will remove the join from the original Counties layer.</p>

<p class=Instructions>In  the <b>TOC</b>, right-click on <b>Counties</b> and select
<b>Joins and Relates &gt;&gt; Remove Join(s) &gt;&gt; Remove All Joins</b>.</p>

<p class=Instructions><img border=0 width=713 height=224 id="Picture 66"
src="Joining_tables_files/image021.png"></p>

<p class=Instructions>Save the document by clicking on the <b>Save</b> button <img
border=0 width=20 height=18 id="Picture 25"
src="Joining_tables_files/image022.png">.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173524">Step 5:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Attempting a join (and failing)</a></p>

</div>

<p class=MsoNormal>Next, you will join another table to the Counties layer. The
table to be joined contains estimated median income data for 2009 (src: US
Census). The table is in a CSV file. A CSV stores data that are separated by
commas.</p>

<p class=Instructions>In the Windows file management window, double-click on the
<span class=InstructionsChar><b>Estimated_median_income_2009</b></span> file
located in the Table_join folder. </p>

<p class=MsoNormal>The file should open in an Excel application. You’ll first
notice that the file stores clean field names that do not risk being modified
following a joined layer export as in Step 4. You’ll also notice that the table
does not have county names listed, instead, the table identifies the county by
ID. This is OK since the Counties layer in the ArcMap document has a county
code column called <b>CNTYCODE</b>.</p>

<p class=MsoNormal><img border=0 width=232 height=179 id="Picture 62"
src="Joining_tables_files/image023.png"></p>

<p class=Instructions><b>Close</b> the Excel file. If prompted to save click <b>Don’t
Save</b>.</p>

<p class=MsoNormal><u><span style='color:#C00000'>NOTE</span></u><span
style='color:#C00000'>: always make sure to close a data file that is open inside
an Excel application before opening it in ArcMap. If you don’t, ArcMap will not
properly open the file because of a file lock placed on the file by the Excel
application.</span></p>

<p class=Instructions>In ArcMap, click on the <b>Add Data</b> button <img
border=0 width=20 height=19 id="Picture 30"
src="Joining_tables_files/image024.png">.</p>

<p class=Instructions>In the <b>Add Data</b> window, select <b>Estimated_median_income_2009.csv</b>.</p>

<p class=Instructions>Click <b>Add</b> to add the data.</p>

<p class=MsoNormal>You now should see the median income table in the table of
content. At this point, it’s always good practice to open the contents of the
table to make sure that all data have been properly read.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Estimated_median_income_2009</b>
table and select <b>Open</b>.</p>

<p class=Instructions><img border=0 width=235 height=213 id="Picture 63"
src="Joining_tables_files/image025.png"></p>

<p class=MsoNormal>It seems that all data and headers were properly imported.
Now let’s try the join. Remember that this time around, we will join the data
table to the Counties table using the County IDs instead of the County names.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Joins and Relates &gt;&gt; Joins</b>.</p>

<p class=Instructions>In the Join Data window, select <b>Join attributes from a
table</b> from the first pull-down option, then <b>CNTYCODE</b> from the second
pull-down menu (this is the column from the Counties layer that is used to join
the table with) and select <b>Estimated_median_income_2009 </b>in the third
pull-down menu.</p>

<p class=Instructions>Now try selecting a field from the <b>Choose the fields
in the table to base the join on</b> pull-down menu. The options should be
blank.</p>

<p class=MsoNormal><img border=0 width=447 height=430 id="Picture 34"
src="Joining_tables_files/image026.png"></p>

<p class=MsoNormal>So what happened? Why is ArcMap not letting us select any
columns from the Excel table? Well not only do the records between both tables
need to match character for character, but they also need to match by <b>data
type</b>. So we need to figure out the data types for each table.</p>

<p class=MsoNormal>If the data table’s attribute table is not opened, go ahead
and open it. (e.g. in the TOC, right-click on the table layer and select <b>open</b>).</p>

<p class=Instructions>In the attribute table, <b>right-click</b> on the
County_ID header and select <b>Properties.</b></p>

<p class=MsoNormal><img border=0 width=258 height=313 id="Picture 64"
src="Joining_tables_files/image027.png"></p>

<p class=MsoNormal>In the Field Properties window, note the data type. The CSV
column was read as a <b>Long</b> data type (which is a numeric data type). <img
border=0 width=324 height=127 id="Picture 65"
src="Joining_tables_files/image028.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Field Properties</b>
window.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Open Attribute Table</b>.</p>

<p class=Instructions>In the Table window, <b>right-click</b> on the <b>CNTYCODE</b>
column header and select <b>Properties</b>.</p>

<p class=MsoNormal>In this table, the county ID is treated as a <b>String</b>
(which is a text or character format) and not a numeric field. Because the data
types between both tables do not match, we cannot join the tables. There are
several solutions to this problem one of which involves converting the string
to a number in ArcMap.</p>

<p class=MsoNormal><img border=0 width=312 height=90 id="Picture 36"
src="Joining_tables_files/image029.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Field Properties</b>
window.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173525">Step 6:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Converting text column to numeric column</a></p>

</div>

<p class=Instructions>In the Counties’ layer attribute table, select Add Field.</p>

<p class=MsoNormal><img border=0 width=336 height=243 id="Picture 67"
src="Joining_tables_files/image030.png"></p>

<p class=Instructions>We’ll assign it the same field name used in the CSV file:
<b>County_ID</b>.</p>

<p class=Instructions>Since the value to be converted are small integers, we’ll
make this field a <b>Short Integer</b>.</p>

<p class=MsoNormal><img border=0 width=298 height=164 id="Picture 68"
src="Joining_tables_files/image031.png"></p>

<p class=MsoNormal>Note that the joined tables do not need to match numeric
data type exactly (i.e. a long integer will gladly join to a short integer).</p>

<p class=Instructions>Click <b>OK</b> to create the new field</p>

<p class=Instructions><b>Right-click</b> on the <b>County_ID</b> column and
select <b>Field Calculator</b>. You might be presented with a warning window
that you can dismiss.</p>

<p class=Instructions>In the expression box, type <span style='font-family:
"Courier New"'>[CNTYCODE]</span>.</p>

<p class=Instructions><img border=0 width=137 height=55 id="Picture 69"
src="Joining_tables_files/image032.png"></p>

<p class=MsoNormal>This assigns the values in CNTYCODE to County_ID. ArcMap
will convert the values from text to numbers in the process. </p>

<p class=Instructions>Click <b>OK</b>.</p>

<p class=MsoNormal><img border=0 width=356 height=192 id="Picture 70"
src="Joining_tables_files/image033.png"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Now that we have matching county ID values between the
Counties layer and the CSV table we can proceed with the join.</p>

<div style='border:solid #548DD4 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#8DB3E2'>

<p class=Stepheader-GIS><a name="_Toc519173526">Step 7:<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Attempting the join one more time</a></p>

</div>

<p class=Instructions><b>Right-click</b> on the <b>Counties</b> layer and
select <b>Joins and Relates &gt;&gt; Joins</b>.</p>

<p class=Instructions>In the Join Data window select the values for each field
as shown below:</p>

<p class=MsoNormal><img border=0 width=400 height=306 id="Picture 71"
src="Joining_tables_files/image034.png"></p>

<p class=Instructions>Click <b>OK</b> to close the Join data window.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Open Attribute table</b>. </p>

<p class=MsoNormal>The median income data is now joined to the Counties layer. </p>

<p class=MsoNormal><img border=0 width=511 height=132 id="Picture 72"
src="Joining_tables_files/image035.png"></p>

<p class=MsoNormal>Remember that this join is temporary. If you want it to be
permanent, you must export it to a new data file. </p>

<p class=MsoNormal>Before exporting the joined layer to a new data file we will
remove unnecessary/redundant attributes.</p>

<p class=Instructions>In the <b>TOC</b>, right-click the <b>Counties</b> layer
and select <b>Properties</b>. </p>

<p class=Instructions>In the Layer Properties window, select <b>Fields</b>.</p>

<p class=MsoNormal><img border=0 width=124 height=28 id="Picture 44"
src="Joining_tables_files/image036.png"></p>

<p class=MsoNormal>This option lets you control which attributes will be useable
within your map session. It also defines which attributes will be exported in
an export process.</p>

<p class=Instructions>You will uncheck the <b>Shape</b>, <b>CountyCode</b> and <b>County_ID</b>
attributes.</p>

<p class=MsoNormal><img border=0 width=309 height=239 id="Picture 73"
src="Joining_tables_files/image037.png"></p>

<p class=Instructions>Click <b>OK</b> to close the <b>Layer Properties</b>
window.</p>

<p class=MsoNormal>If you view the Counties layer attribute table, you should
see just three columns. </p>

<p class=MsoNormal>Now we are ready to export the layer to a new data file.</p>

<p class=Instructions>In the TOC, <b>right-click</b> on the <b>Counties</b>
layer and select <b>Data &gt;&gt; Export Data</b>.</p>

<p class=Instructions>Name the new data file <b>Income_by_county.shp</b>. Make
sure to save it as a shapefile.</p>

<p class=MsoNormal><img border=0 width=395 height=231 id="Picture 74"
src="Joining_tables_files/image038.png"></p>

<p class=Instructions>Click <b>OK</b> to proceed with the export.</p>

<p class=Instructions>When asked if the exported data should be added to the
map as a layer, click <b>Yes</b>.</p>

<p class=MsoNormal>Go ahead and symbolize the newly added layer using the <b>Income09
</b>attribute (this is the estimated median income attribute). If you forgot
how to symbolize a layer, see Step 3.</p>

<p class=MsoNormal><img border=0 width=225 height=298 id="Picture 50"
src="Joining_tables_files/image039.png"></p>

<p class=Instructions><b>Save</b> the MXD file.</p>

<p class=MsoNormal>This completes the steps for this exercise.</p>

<div class=MsoNormal align=center style='margin-top:7.5pt;margin-right:0in;
margin-bottom:7.5pt;margin-left:0in;text-align:center;line-height:13.0pt'><span
style='font-size:10.0pt;color:black'>

<hr size=1 width="100%" noshade style='color:#CCCCCC' align=center>

</span></div>

<p class=MsoNormal style='margin-top:7.5pt;margin-right:0in;margin-bottom:7.5pt;
margin-left:0in;line-height:13.0pt'><span style='font-size:10.0pt;color:gray'><img
border=0 width=76 height=27 id="Picture 6"
src="Joining_tables_files/image040.png"></span><span style='font-size:10.0pt;
color:gray'> Manuel Gimond, last modified on 7/12/2018 </span></p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
